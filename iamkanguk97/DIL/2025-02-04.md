# 챕터7) 보조기억장치

## 7-1) 다양한 보조기억장치

## 하드디스크 (자기디스크)

> 사진은 책 참고 !

-   `플래터`: 실질적으로 데이터가 저장되는 곳. 여러 면을 위치시킨다.
-   `스핀들`: 플래터를 회전시키는 요소. 분당 회전수는 RPM (분당 회전수)
-   `헤드`: 플래터를 대상으로 데이터를 읽고 쓰는 구성 요소
-   `디스크 암`: 헤드를 움직여주는 요소

### 하드디스크 - 저장 단위

-   `트랙`: 플래터의 동심원
-   `섹터`: 플래터를 여러 동심원으로 나눴을 때의 조각
-   `실린더`: 여러 면의 플래터가 사용될 때 같은 트랙이 위치한 곳을 모아서 연결한 단위

**참고로 연속된 정보는 보통 한 실린더에 기록된다. 예를 들어, 2개의 플래터를 사용하는 하드 디스크에서 네 개 섹터에 걸쳐서 데이터를 저장할 때는 첫 번째 플래터 윗면, 뒷면과 두 번째 플래터 윗면과 아랫면에 데이터를 저장함. 이유는 디스크 암을 움직이지 않고도 바로 데이터에 접근할 수 있기 때문이다.**

### 하드디스크 - 데이터에 접근하는 시간

-   탐색 시간: 접근하려는 데이터가 저장된 트랙까지 헤드를 이동시키는 시간
-   회전 지연: 헤드가 있는 곳으로 플래터를 회전시키는 시간
-   전송 시간: 하드디스크와 컴퓨터 간에 데이터를 전송하는 시간

## 플래시 메모리

> -   USB 메모리, SD 카드 등
> -   전기적으로 데이터를 읽고 쓸 수 있는 반도체 기반의 저장 장치
> -   ROM에도 사용되고 거의 모든 전자 제품 안에 플래시 메모리가 내장되어 있음

### NAND 플래시 메모리와 NOR 플래시 메모리

> -   NAND: NOT AND -> 둘다 1일때만 0, 나머지 경우는 1
> -   NOR: NOT OR -> 둘다 0일때만 1, 나머지 경우는 0

대용량 저장장치로 많이 사용되는 플래시 메모리는 NAND 플래시 메모리이다.

-   셀: 플래시 메모리에서 데이터를 저장하는 가장 작은 단위. 셀이 모여서 MB, GB, TB 용량을 갖는 저장 장치가 됨
-   하나의 셀에 몇 비트를 저장할 수 있는지에 따라 종류가 나뉨
-   SLC(1비트), MLC(2비트), TLC(3비트), QLC(4비트)

### 플래시 메모리와 하드 디스크는 수명이 있음

-   하나의 셀에 일정 횟수 이상 데이터를 쓰고 지우면 해당 셀에 데이터를 저장할 수 없음.

### SLC 타입 (Single Level Cell)

-   한 셀로 2개의 정보를 표현할 수 있음. (혼자 집에 살음)
-   비트의 빠른 입출력이 가능함.
-   수명도 MLC나 TLC 타입보다 길어서 많이 데이터를 쓰고 지우고 할 수 있음. 하지만 용량 대비 가격이 높음.
-   그래서 기업에서 데이터를 읽고 쓰는 작업이 매우 많이 반복되며 고성능의 빠른 저장장치가 필요한 경우에 사용한다.

### MLC (Multiple Level Cell)

-   한 셀로 4개의 정보를 표현할 수 있음.
-   훨씬 더 많은 사람을 수용할 수 있음.
-   SLC 보다 용량 대비 가격이 저렴함
-   시중에서 사용되는 많은 플래시 메모리 저장 장치들이 MLC 또는 TLC 타입으로 만들어짐

### TLC (Triple Level Cell)

-   한 셀로 8개의 정보를 표현할 수 있음. 그래서 대용량화 하기가 유리하다.
-   일반적으로 수명과 속도가 떨어지지만 용량대비 가격도 저렴하다.

### 페이지, 블록, 플레인, 다이 그리고 단위

-   페이지: 셀들이 모여서 만들어진 단위
-   블록: 페이지가 모여서 만들어진 단위
-   플레인: 블록이 모여 만들어진 단위
-   다이: 플레인이 모여서 만들어진 단위

**플래시 메모리에서 읽기/쓰기는 페이지 단위로 이루어지지만 삭제는 페이지보다 큰 블록 단위로 이루어진다.**

### 페이지의 상태

-   Free: 어떠한 데이터도 저장하고 있지 않아서 새로운 데이터를 저장할 수 있는 상태
-   Valid: 이미 유효한 데이터를 저장하고 있는 상태
-   Invalid: 쓰레기값이라 부르는 유효하지 않은 데이터를 저장하고 있는 상태

참고로, 플레시 메모리는 하드 디스크와는 달리 덮어쓰기가 불가능하기 때문에 Valid 상태인 페이지에서는 새 데이터를 저장할 수 없다.

### 가비지 컬렉션 (Garbage Collection)

> 쓰레기값을 정리하기 위한 기능

<하드디스크와 플래시 메모리에서의 가비지 컬렉션>

-   Valid한 페이지들만의 새로운 블록으로 복사함
-   기존의 블록을 삭제함

<br/>

## 7-2) RAID의 정의와 종류

1TB HDD 4개와 4TB HDD 1개를 비교해면 어떨까?<br/>
1TB HDD 4개로 RAID를 구성하면 4TB HDD 1개의 성능과 안전성보다 더 좋은 효율을 뽑아낼 수 있다.

## RAID의 정의

> 보조기억장치에도 수명이 있다. 그래서 단순하게 보조기억장치에 어떻게든 저장만 하면 된다는 단순한 생각을 하면 안된다.

-   RAID: Redundant Array of Independent Disks
-   주로 하드디스크와 SSD를 사용하는 기술
-   **데이터의 안전성 혹은 높은 성능을 위해 여러 개의 물리적 보조기억장치를 마치 하나의 논리적 보조기억장치처럼 사용하는 기술**

## RAID의 종류

-   RAID 0부터 RAID 6까지 있다.
-   이로부터 파생된 RAID 10, RAID 50 등이 있다.
-   대중적인 0,1,4,5,6 에 대해서 알아보자.

## RAID 0

> 여러 개의 보조기억장치에 데이터를 나눠서 저장하는 구성방식

예를 들어 1TB 하드디스크 4개로 RAID 0을 구성했다고 가정해보자.
그리고 저장하려는 데이터가 4TB 라고 한다면 하드디스크 개수인 4개만큼 나뉘어서 저장되는 것이다.

A1234 / B1234 / C1234 / D1234

A1 A2 A3 A4<br/>
B1 B2 B3 B4<br/>
C1 C2 C3 C4<br/>
D1 D2 D3 D4<br/>

이렇게 저장되는 것이다. 위와 같은 데이터의 구조적인 특징으로는 저장된 데이터를 읽고 쓰는 속도가 빨라진다.

그래서 4TB 저장 장치 1개를 읽고 쓰는 속도보다 RAID 0으로 구성된 1TB 저장 장치 4개의 속도가 이론상 4배 가량 빠르다.

**하지만 저장된 정보가 안전하지 않다는 단점이 있다.** 만약 구성된 디스크 중 하나가 문제가 발생한다면 다른 모든 하드디스크의 정보를 읽는데 문제가 발생할 수 있다. 그래서 RAID 1이 등장했다.

## RAID 1

> 복사본을 만드는 방식. 그래서 미러링이라고도 부른다.

A1 A2 | A1 A2<br/>
B1 B2 | B1 B2<br/>
C1 C2 | C1 C2<br/>
D1 D2 | D1 D2<br/>

이렇게 저장되는 것이다. 그래서 RAID 1에 어떠한 데이터를 쓴다고 했을 때 원본과 복사본 두군데에 쓴다. 그래서 쓰기 속도는 RAID 0보다 속도가 느리다.

그렇지만 복구가 간단하다는 장점은 있다. 다만, 사용 가능한 용량이 작아진다는 단점이 있다. 그리고 비용이 증가한다는 단점이 있다.

## RAID 4

> RAID 1과 동일하게 완전한 복사본을 만드는 대신 오류를 검출하고 복구하기 위한 정보를 저장한 장치를 두는 구성 방식

-   패리티 비트: 오류를 검출하고 복구하기 위한 정보를 저장한 장치
-   RAID 1보다 적은 하드디스크로도 데이터를 안전하게 보관할 수 있다.

저장하려는 데이터(3TB): A123 / B123 / C123

A1 | A2 | A3 | PA(패리티 A)<br/>
B1 | B2 | B3 | PB(패리티 B)<br/>
C1 | C2 | C3 | PC(패리티 C)<br/>
D1 | D2 | D3 | PD(패리티 D)<br/>

이렇게 저장되는 것이다.

원래 패리티 비트는 오류 검출만 가능하지 복구는 불가능하다.
하지만 RAID 에서는 패리티 값으로 오류 수정도 가능하다.

## RAID 5

> -   RAID 4에서는 어떤 새로운 데이터가 저장될 때마다 패리티 비트를 저장하는 디스크에도 데이터를 쓰게 되기 때문에 패리티를 저장하는 장치에 병목 현상이 발생할 수도 있다는 단점이 있다.
> -   이를 해결하기 위한 장치이다.

A1 A2 A3 PA<br/>
B1 B2 PB B3<br/>
C1 PC C2 C3<br/>
PD D1 D2 D3<br/>

**결국 RAID4는 패리티를 저장한 장치를 따로 두는 것이고, RAID5는 패리티를 분산시켜 저장하는 방식이다.**

## RAID 6

> -   구성은 RAID5와 동일함.
> -   다만 서로 다른 2개의 패리티를 두는 방식
> -   즉, 오류를 검출하고 복구할 수 있는 수단이 2개
> -   다만 패리티가 2개이기 때문에 쓰기 속도가 느려진다.
> -   즉, 쓰기 속도가 느리더라도 데이터를 더욱 안전하게 보관하고 싶을 때 사용하는 방식

A1 A2 A3 P1A P2A<br/>
B1 B2 P1B P2B B3<br/>
...
