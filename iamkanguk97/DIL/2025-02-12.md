# 챕터11) 프로세스 동기화

## 동기화의 의미

워드 프로세서에는 사용자로부터 입력을 받는 프로세스, 입력한 내용의 맞춤법을 검사하는 프로세스, 입력한 내용을 화면에 출력하는 프로세스 등이 있다.<br/>
이 프로세스들은 각기 다른 독립적인 프로세스지만 공동의 목표를 위해 협력하는 존재이다.

위와 같은 상황에서, 협력적으로 실행되는 프로세스들은 아무렇게나 동시에 실행되면 안된다. 올바른 실행을 위해서 `동기화`는 필수적이다.

`프로세스 동기화`는 **프로세스들 사이의 수행 시기를 맞추는 작업**을 의미한다. 프로세스를 올바른 순서대로 실행하는 `실행 순서 제어` 작업과, 동시에 접근해서는 안 되는 자원에 하나의 프로세스만 접근하게 하는 `상호 배제` 작업이 있다.<br/>
참고로, 프로세스 뿐만 아니라 스레드도 동기화 대상이다.

### 실행 순서 제어를 위한 동기화

Reader 프로세스와 Writer 프로세스가 있다고 가정해보면, 당연히 Writer 프로세스가 먼저 수행이 되어야 Reader 프로세스가 정상적인 수행이 가능할 것이다.
이렇게 동시에 실행되는 프로세스를 올바른 순서대로 실행하는 것이 실행 순서 제어를 위한 동기화.

### 상호 배제를 위한 동기화

> `상호 배제(Mutual Exclusion)`: 공유가 불가능한 자원의 동시 사용을 피하기 위해 사용하는 알고리즘

동시에 접근해서는 안되는 자원에 동시에 접근하지 못하게 하는 것이 상호 배제를 위한 동기화이다.<br/>
예를 들면, 통장에 10만원이 있는데 2만원을 추가 저축하는 프로세스와 5만원을 추가 저축하는 프로세스가 있는데, 하나의 프로세스가 끝나고 나서 2번째 프로세스가 수행이 되어야 하는데
만약 공유 자원에 동시에 접근하게 되면 총합계 금액이 맞지 않을 수 있는 이슈가 발생할 수 있다.

<br/>

## 생산자와 소비자 문제

> -   생산자: 물건을 계속해서 생산하는 프로세스
> -   소비자: 물건을 계속해서 소비하는 프로세스

예제 삽입 예정

<br/>

## 공유 자원과 임계 구역

> -   동시에 접근해서는 안되는 자원이란?
> -   `공유 자원`: `잔액` 이나 `총합`과 같은 데이터. 전역 변수가 될 수 있고, 파일이 될 수 있으며 심지어 입출력장치나 보조기억장치가 될 수도 있다.
> -   **동시에 실행하면 문제가 발생하는 자원에 접근하는 코드 영역을 임계 구역(Critical Section) 이라고 한다.**

### Race Condition

-   Critical Section은 2개 이상의 프로세스가 동시에 실행되면 안 되는 영역이다. 그런데 잘못된 실행으로 인해 여러 프로세스가 동시 다발적으로 임계 구역의 코드를 실행해서 문제가 발생하는 경우가 있는데 이를 레이스 컨디션이라고 한다.
-   총합 변수를 1 증가시키거나 1 감소시키는 코드는 고급언어에서는 1줄이면 되지만, 기계어로 변환되면 여러줄로 변형된다.
-   **저급언어로 변환된 결과를 실행하다가 Context-Switching이 발생할 수 있는데 그러면 총합 결과가 기댓값과 다를 수 있다.**

운영체제는 이러한 Critial Section 문제를 3가지 원칙하에 해결한다.

-   Mutual Exclusion: 한 프로세스가 임계 구역에 진입하면 다른 프로세스는 들어올 수 없음
-   Progress: 임계 구역에 어떤 프로세스도 진입하지 않았으면 임계 구역에 진입하고자 하는 프로세스는 들어갈 수 있어야 한다.
-   Bounded Waiting: 한 프로세스가 임계 구역에 진입하고 싶다면 그 프로세스는 언젠가는 임계 구역에 들어갈 수 있어야 한다.
