# 문맥 교환(Context-Switching)

> 이번 글에서는 Context-Switching과 PCB, 그리고 인터럽트에 대해서 정리를 해보려고 한다.

## 정의

멀티 프로세스 환경에서 CPU가 하나의 프로세스를 실행하고 있는 상태에서 인터럽트 요청에 의해 다음 우선 순위의 프로세스가 실행되어야 할 때 **기존의 프로세스의 상태 또는 레지스터값(context)을 저장하고 CPU가 다음 프로세스를 수행하도록 새로운 프로세스의 상태 또는 레지스터값(context)를 교체하는 작업**을 `Context-Switching` 이라고 한다.

<br/>

## Context

> **사용자와 다른 사용자, 사용자와 시스템 또는 디바이스간의 상호작용에 영향을 미치는 사람, 장소, 개체등의 현재 상황(상태)을 규정하는 정보들**

-   OS 레벨에서의 Context는 **CPU가 해당 프로세스를 실행하기 위한 해당 프로세스의 정보들이다.**
-   Context는 `프로세스의 PCB(Process-Control Block)`에 저장된다.
-   그래서 Context-Switching 때 PCB의 정보를 읽어서 CPU가 전에 프로세스가 일을 하던 것에서 이어서 수행이 가능한 것이다.

### PCB란 무엇이고, PCB에는 어떤 정보를 저장하는가?

#### PCB(Process-Control Block)

모든 프로세스는 실행을 위해서 CPU를 필요로 하지만 CPU 라는 자원은 한정된 자원이다. 다시 말해서, 모든 프로세스는 CPU를 동시에 사용할 수 없다.<br/>
운영체제는 빠르게 번갈아서 수행되는 프로세스의 실행 순서를 관리하고, 프로세스에 CPU를 비롯한 자원을 배분한다. 이를 위해서 운영체제는 `프로세스 제어 블록`을 이용한다.

PCB는 프로세스와 관련된 정보를 저장하는 자료구조이다. 상품에 달려있는 태그와 같다고 생각하자.<br/>
그리고, PCB는 유저 영역과 커널 영역에서 커널 영역에 생성된다.<br/>
프로세스 생성 시에 만들어지고, 실행이 끝나면 폐기된다.

#### PCB에 기록되는 요소

-   `프로세스ID (PID)`
-   `레지스터값`: 자신의 실행차례가 돌아오면 이전까지 사용했던 레지스터의 중간값들을 복원해야 이전까지 진행했던 작업을 이어서 실행할 수 있다.
-   `프로세스 상태`: 생성,준비,실행,대기,종료
-   `CPU 스케줄링 정보`: 프로세스가 언제, 어떤 순서로 CPU를 할당받을지에 대한 정보
-   `메모리 관리 정보`: 프로세스마다 메모리에 저장된 위치가 다르기 때문에 기록해야 한다.
-   `사용한 파일과 입출력장치 목록`

> **참고로, Context-Switching 때 해당 CPU는 아무런 일을 하지 못한다. 따라서 컨텍스트 스위칭이 잦아지면 오히려 Overhead가 발생해서 효율을 떨어뜨릴 수 있다.**

<br/>

## 인터럽트(Interrupt)

> CPU가 프로그램을 실행하고 있을 때 실행중인

-   https://jeong-pro.tistory.com/93
